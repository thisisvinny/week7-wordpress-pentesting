# Project 7 - WordPress Pentesting

Time spent: **8** hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

1. Authenticated Cross-Site Scripting (XSS) via Media File Metadata
  - [ ] Summary: Metadata of MP3 files are not sanitized properly. If JavaScript was in the metadata, it would be executed by WordPress. 
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.7.3
  - [ ] GIF Walkthrough: ![](https://github.com/thisisvinny/week7-wordpress_pentesting/blob/master/XSS_MP3_Metadata.gif)
  - [ ] Steps to recreate: Create an MP3 file with metadata as the JavaScript code you want to be executed. On WordPress, create a post, then insert an audio playlist containing this MP3. 
  - [ ] Affected source code:
    - [https://core.trac.wordpress.org/browser/trunk/src/wp-includes/media.php](https://core.trac.wordpress.org/browser/trunk/src/wp-includes/media.php)
    
2. Unauthenticated Stored Cross-Site Scripting (XSS)
  - [ ] Summary: When viewing a long comment on WordPress, JavaScript code can be executed. Attackers can abuse this by inserting malicious scripts within their long comments.
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.1
  - [ ] GIF Walkthrough: ![](https://github.com/thisisvinny/week7-wordpress_pentesting/blob/master/XSS_Comment.gif)
  - [ ] Steps to recreate: Begin a comment on a post. Your comment should include JavaScript code you want executed as attributes within HTML tags. Your comment should also be at least 64kb in size (fill the comment with filler letters). Post the comment. When you hover your mouse over the comment, your attack will be executed.
  - [ ] Affected source code:
    - [https://core.trac.wordpress.org/browser/trunk/src/wp-includes/comment.php](https://core.trac.wordpress.org/browser/trunk/src/wp-includes/comment.php)
    
3. Authenticated Stored Cross-Site Scripting (XSS) in YouTube URL Embeds
  - [ ] Summary: YouTube URL embeds can include JavaScript code through the use of escape sequences.
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.7.3
  - [ ] GIF Walkthrough: ![](https://github.com/thisisvinny/week7-wordpress_pentesting/blob/master/XSS_YoutubeURL.gif)
  - [ ] Steps to recreate: In a post in WordPress, embed a YouTube URL that uses escape sequences to include JavaScript code.
  - [ ] Affected source code:
    - [https://core.trac.wordpress.org/browser/trunk/src/wp-includes/embed.php](https://core.trac.wordpress.org/browser/trunk/src/wp-includes/embed.php)

## Assets

List any additional assets, such as scripts or files

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

Describe any challenges encountered while doing the work

YouTube URL Embeds XSS was not working on my host browser. But when I viewed the post in KaliVM it worked.

## License

    Copyright [yyyy] [name of copyright owner]

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
